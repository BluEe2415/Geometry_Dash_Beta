<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Mini Geometry Dash</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #222;
    height: 100%;
    width: 100%;
    font-family: Arial, sans-serif;
  }
  canvas {
    display: block;
  }
  #restartButton {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 20px 40px;
    font-size: 24px;
    background-color: #fff;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    display: none; /* initially hidden */
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<button id="restartButton">Restart</button>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const restartButton = document.getElementById('restartButton');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player;
let obstacles;
let obstacleTimer;
let speed;
let score;
let gameOver;

function initGame() {
    player = {
        x: 50,
        y: canvas.height - 80,
        width: 60,
        height: 60,
        dy: 0,
        gravity: 1,
        jumpPower: -20,
        onGround: true
    };
    obstacles = [];
    obstacleTimer = 0;
    speed = 8;
    score = 0;
    gameOver = false;
    restartButton.style.display = 'none';
}

function spawnObstacle() {
    let height = Math.random() * 100 + 40;
    obstacles.push({
        x: canvas.width,
        y: canvas.height - height,
        width: 30,
        height: height
    });
}

function update() {
    if(gameOver) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Spieler Physik
    player.dy += player.gravity;
    player.y += player.dy;

    if(player.y + player.height > canvas.height) {
        player.y = canvas.height - player.height;
        player.dy = 0;
        player.onGround = true;
    }

    // Hindernisse
    obstacleTimer++;
    if(obstacleTimer > 90) {
        spawnObstacle();
        obstacleTimer = 0;
    }

    for(let i = obstacles.length - 1; i >= 0; i--) {
        obstacles[i].x -= speed;
        if(obstacles[i].x + obstacles[i].width < 0) {
            obstacles.splice(i, 1);
            score++;
        }

        // Kollision
        if(player.x < obstacles[i].x + obstacles[i].width &&
           player.x + player.width > obstacles[i].x &&
           player.y < obstacles[i].y + obstacles[i].height &&
           player.y + player.height > obstacles[i].y) {
            gameOver = true;
            restartButton.style.display = 'block';
        }

        // Hindernis zeichnen
        ctx.fillStyle = 'red';
        ctx.fillRect(obstacles[i].x, obstacles[i].y, obstacles[i].width, obstacles[i].height);
    }

    // Spieler zeichnen
    ctx.fillStyle = 'white';
    ctx.fillRect(player.x, player.y, player.width, player.height);
    ctx.fillStyle = 'black';
    ctx.font = `${player.height/1.5}px Arial`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('67', player.x + player.width/2, player.y + player.height/2);

    // Score oben in der Mitte
    ctx.fillStyle = 'white';
    ctx.font = '30px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('Score: ' + score, canvas.width/2, 50);

    requestAnimationFrame(update);
}

// Springen per Klick oder Touch
function jump() {
    if(player.onGround && !gameOver) {
        player.dy = player.jumpPower;
        player.onGround = false;
    }
}

document.addEventListener('mousedown', jump);
document.addEventListener('touchstart', jump);

// Restart Button Funktion
restartButton.addEventListener('click', () => {
    initGame();
    update();
});

// Fenstergröße dynamisch anpassen
window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    if(player) player.y = canvas.height - player.height;
});

// Spiel initialisieren
initGame();
update();
</script>
</body>
</html>
